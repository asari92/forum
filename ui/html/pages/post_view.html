{{define "title"}}Post #{{.Post.ID}}{{end}}

{{define "main"}}
<div class='snippet'>
    {{with .Post}}
    <div class='metadata'>
        <h2 class="post-title">{{.Title}}</h2>
        <span class="post-id">#{{.ID}}</span>   
    </div>
    <div class="post-content">
        <pre><code>{{.Content}}</code></pre>
    </div>
    {{end}}

    <!-- Комментарии -->
    <div class="comments-section">
        <h3>Comments</h3>
        {{with .Comments}}
        <ul class="comment-list">
            {{range .}}
            <li class="comment">
                <div class="comment-metadata">
                    <strong>UserID: {{.UserID}}</strong>
                    <time>{{ .Created}}</time>
                </div>
                <div class="comment-content">{{.Content}}</div>
            </li>
            {{else}}
            <p>No comments yet. Be the first to comment!</p>
            {{end}}
        </ul>
        {{end}}
    </div>
    
    <!-- Форма для создания комментария -->
    <div class="comment-section">
        <h3>Leave a Comment</h3>
        <form method="POST" action="/comment/create" class="comment-form">
            <input type="hidden" name="token" value="{{.CSRFToken}}">
            <input type="hidden" name="postID" value="{{.Post.ID}}">
            <textarea name="content" placeholder="Write your comment here..." required class="comment-input"></textarea>
            <button type="submit" class="comment-submit-btn">Submit</button>
        </form>
    </div>

    <!-- Категории -->
    <div class="metadata">
        <form method="POST" action="/">
            <input type="hidden" name="token" value="{{.CSRFToken}}">
            <strong>Categories: </strong>
            <div class="categories">
                {{range .Categories}}
                <button type="submit" name="categories" value="{{.ID}}" class="category-link">{{.Name}}</button>
                {{end}}
            </div>
        </form>
    </div>

    <!-- Лайки и дизлайки -->
    <div class='reaction-buttons'>
        <form method="POST" action="/post/view/{{.Post.ID}}">
            <input type="hidden" name="token" value="{{.CSRFToken}}">
            <input type="hidden" name="post_id" value="{{.Post.ID}}">
            <button type="submit" name="is_like" value="true" class="like-button">
                <span class="icon {{if and .ReactionData.UserReaction .ReactionData.UserReaction.IsLike}}icon-like-active{{else}}icon-like{{end}}">{{.ReactionData.Likes}} 👍</span>
            </button>
            <button type="submit" name="is_like" value="false" class="dislike-button">
                <span class="icon {{if and .ReactionData.UserReaction (not .ReactionData.UserReaction.IsLike)}}icon-dislike-active{{else}}icon-dislike{{end}}">{{.ReactionData.Dislikes}} 👎</span>
            </button>
        </form>
    </div>
</div>
{{end}}
